_root._quality = "high";
gquality = "high";
game = { tileW: 20, tileH: 20, visx: 15, visy: 25, pushy: 100, tilenumber: 76 };
game.eMenu = false;
game.levelsCompleted = 1;
game.originTimer = 220;
game.rebornTimer = 23;
game.cdir = 1;
game.dustn = 0;
game.markn = 0;
game.ctimerone = 50;
game.ctimertwo = 50;
game.ctimerthree = 50;
game.missilen = 0;
game.dustArray = new Array();
game.smartMark = new Array();
game.mArray = new Array();
game.bsync = 20;
game.msync = 50;
game.damsync = 50;
game.ctiletype = 1;
game.blockplace = 1;
game.bnumber = 0;
game.deathCounter = 0;
game.comicStage = 1;
game.deathStage = 1;
game.importStage = 1;
game.death = false;
game.inputMidStage = 1;
game.customLevels = 0;
game.depth = 2;
game.mouseCheckW = 0;
game.mouseCheckH = 0;
game.c = 1;
game.menuStage = "unloaded";
game.menuBuilt = false;
game.textOneW = 40;
game.textOneH = 20;
game.textTwoW = 100;
game.textTwoH = 20;
game.textThreeW = 250;
game.textThreeH = 250;
game.textFourW = 250;
game.textFourH = 60;
game.textFiveW = 150;
game.textFiveH = 20;
game.textSixW = 350;
game.textSixH = 65;
game.textSevenW = 200;
game.textSevenH = 200;
game.creationStage = 1;
game.mapnumber = 1;
game.mapamount = 61;
_root.createEmptyMovieClip("OverL", game.depth);
game.clip = _root.OverL;
game.depth = game.depth + 1;
game.mouse = false;
game.mouseup = true;
game.custom = new Object();
game.use = new Object();
game.xcharspeed = 8;
game.xcurrentspeed = 0;
game.maxVel = 15;
game.mapBuilt = false;
game.mouseTracker = false;
game.enter = true;
game.pause = false;

game.buildmap = function (map, char) {
    game.halfvisx = int(game.visx / 2);
    game.halfvisy = int(game.visy / 2);
    mapWidth = map.length;
    mapHeight = map[0].length;
    game.mVW = Math.floor(Stage.width / game.tileW);
    game.mVH = Math.floor(Stage.height / game.tileH) + 2;
    game.mW = map.length;
    game.mH = map[0].length;
    game.currentStageY = mapHeight - game.mVH;
    game.cliprealheight = map[0].length * game.tileH;
    i = 0;
    while (i < mapHeight) {
        j = 0;
        while (j < mapWidth) {
            var _loc1_ = "t_" + j + "_" + i;
            game.use[_loc1_] = new game."tile" + map[j][i]();
            game.use[_loc1_].x = j * game.tileW;
            game.use[_loc1_].y = i * game.tileH;
            j++;
        }
        i++;
    }
    i = game.currentStageY;
    while (i < game.mVH + game.currentStageY) {
        j = 0;
        while (j < game.mVW) {
            if (i >= 0) {
                _loc1_ = "t_" + j + "_" + i;
                game.clip.attachMovie("tile", _loc1_, game.depth);
                game.depth = game.depth + 1;
                game.clip[_loc1_].gotoAndStop(game.use[_loc1_].frame);
                game.clip[_loc1_]._x = game.use[_loc1_].x;
                game.clip[_loc1_]._y = game.use[_loc1_].y;
            }
            j++;
        }
        i++;
    }
    game.clip._y = (game.cliprealheight - Stage.height) * -1;
    if (game.bgirlon == true) {
        game.clip.attachMovie("bchar", "char", game.depth);
    }
    else if (game.ccon == true) {
        game.clip.attachMovie("cchar", "char", game.depth);
    }
    else if (game.drfeton == true) {
        game.clip.attachMovie("fchar", "char", game.depth);
    }
    else if (game.gishon == true) {
        game.clip.attachMovie("gchar", "char", game.depth);
    }
    else {
        game.clip.attachMovie("char", "char", game.depth);
    }
    game.depth = game.depth + 1;
    char.clip = game.clip.char;
    char.width = (char.clip._width - 6) / 2;
    char.height = char.clip._height / 2;
    char.x = char.xtile * game.tileW + (game.tileW / 2 - char.width);
    char.y = char.ytile * game.tileH + (game.tileH - char.height * 2);
    char.jump = false;
    char.clip._x = char.x;
    char.clip._y = char.y;
};
game.detectkeys = function (ob) {
    game.grabCorners(ob.x - 1, ob.y, ob);
    if (!ob.upleft || !ob.downleft) {
        game.xcurrentspeed = 0;
    }
    game.grabCorners(ob.x - 1, ob.y + 1, ob);
    if (ob.uprightK && ob.downrightK || ob.downrightK && ob.downleftK || ob.upleftK && ob.uprightK || ob.downleftK && ob.upleftK) {
        game.death = true;
    }
    else if (ob.uprightK && ob.downright && ob.downleft && ob.upleft || ob.downrightK && ob.downleft && ob.upleft && ob.upright || ob.upleftK && ob.upright && ob.downleft && ob.downright || ob.downleftK && ob.upleft && ob.upright && ob.downright) {
        game.death = true;
        trace("thisone");
    }
    else if (ob.upright && ob.downleft && ob.upleft && ob.downrightK || ob.downright && ob.upleft && ob.upright && ob.downleftK || ob.upleft && ob.downleft && ob.downright && ob.uprightK || ob.downleft && ob.upright && ob.downright && ob.upleftK) {
        game.death = true;
        trace("thistwo");
    }
    game.grabCorners(ob.x - 1, ob.y - 1, ob);
    if (ob.uprightK && ob.downrightK || ob.downrightK && ob.downleftK || ob.upleftK && ob.uprightK || ob.downleftK && ob.upleftK) {
        game.death = true;
    }
    else if (ob.uprightK && ob.downright && ob.downleft && ob.upleft || ob.downrightK && ob.downleft && ob.upleft && ob.upright || ob.upleftK && ob.upright && ob.downleft && ob.downright || ob.downleftK && ob.upleft && ob.upright && ob.downright) {
        game.death = true;
        trace("thisone");
    }
    else if (ob.upright && ob.downleft && ob.upleft && ob.downrightK || ob.downright && ob.upleft && ob.upright && ob.downleftK || ob.upleft && ob.downleft && ob.downright && ob.uprightK || ob.downleft && ob.upright && ob.downright && ob.upleftK) {
        game.death = true;
        trace("thistwo");
    }
    game.grabCorners(ob.x + 1, ob.y, ob);
    if (!ob.upright || !ob.downright) {
        game.xcurrentspeed = 0;
    }
    game.grabCorners(ob.x + 1, ob.y + 1, ob);
    if (ob.uprightK && ob.downrightK || ob.downrightK && ob.downleftK || ob.upleftK && ob.uprightK || ob.downleftK && ob.upleftK) {
        game.death = true;
    }
    else if (ob.uprightK && ob.downright && ob.downleft && ob.upleft || ob.downrightK && ob.downleft && ob.upleft && ob.upright || ob.upleftK && ob.upright && ob.downleft && ob.downright || ob.downleftK && ob.upleft && ob.upright && ob.downright) {
        game.death = true;
        trace("thisone");
    }
    else if (ob.upright && ob.downleft && ob.upleft && ob.downrightK || ob.downright && ob.upleft && ob.upright && ob.downleftK || ob.upleft && ob.downleft && ob.downright && ob.uprightK || ob.downleft && ob.upright && ob.downright && ob.upleftK) {
        game.death = true;
        trace("thistwo");
    }
    game.grabCorners(ob.x + 1, ob.y - 1, ob);
    if (ob.uprightK && ob.downrightK || ob.downrightK && ob.downleftK || ob.upleftK && ob.uprightK || ob.downleftK && ob.upleftK) {
        game.death = true;
    }
    else if (ob.uprightK && ob.downright && ob.downleft && ob.upleft || ob.downrightK && ob.downleft && ob.upleft && ob.upright || ob.upleftK && ob.upright && ob.downleft && ob.downright || ob.downleftK && ob.upleft && ob.upright && ob.downright) {
        game.death = true;
        trace("thisone");
    }
    else if (ob.upright && ob.downleft && ob.upleft && ob.downrightK || ob.downright && ob.upleft && ob.upright && ob.downleftK || ob.upleft && ob.downleft && ob.downright && ob.uprightK || ob.downleft && ob.upright && ob.downright && ob.upleftK) {
        game.death = true;
        trace("thistwo");
    }
    if (Key.isDown(39) && game.xcurrentspeed < game.xcharspeed) {
        game.cdir = 1;
        game.xcurrentspeed = game.xcurrentspeed + 1;
        if (ob.jump == false) {
            game.xcurrentspeed = game.xcurrentspeed + 1;
        }
    }
    else if (Key.isDown(37) && game.xcurrentspeed > game.xcharspeed * -1) {
        game.cdir = -1;
        game.xcurrentspeed = game.xcurrentspeed - 1;
        if (ob.jump == false) {
            game.xcurrentspeed = game.xcurrentspeed - 1;
        }
    }
    else if (!Key.isDown(37) && !Key.isDown(39) || Key.isDown(37) && Key.isDown(39)) {
        if (game.xcurrentspeed < 2 && game.xcurrentspeed > -2) {
            game.xcurrentspeed = 0;
        }
        else if (game.xcurrentspeed > 0) {
            game.xcurrentspeed = game.xcurrentspeed - 0.25;
            if (ob.jump == false) {
                game.xcurrentspeed = game.xcurrentspeed - 2.75;
            }
        }
        else if (game.xcurrentspeed < 0) {
            game.xcurrentspeed = game.xcurrentspeed + 0.25;
            if (ob.jump == false) {
                game.xcurrentspeed = game.xcurrentspeed + 2.75;
            }
        }
    }
    game.jumpcheck(ob);
    if (ob.velocity > 0) {
        diry = 1;
    }
    else if (ob.velocity < 0) {
        diry = -1;
    }
    else {
        diry = 0;
    }
    if (game.xcurrentspeed > 0) {
        dirx = 1;
    }
    else if (game.xcurrentspeed < 0) {
        dirx = -1;
    }
    else {
        dirx = 0;
    }
    if (ob.velocity - ob.ypull < game.maxVel && ob.velocity - ob.ypull > game.maxVel * -1) {
        ob.velocity = ob.velocity - ob.ypull;
    }
    else if (ob.velocity - ob.ypull > game.maxVel) {
        ob.velocity = game.maxVel;
    }
    else if (ob.velocity - ob.ypull < game.maxVel * -1) {
        ob.velocity = game.maxVel * -1;
    }
    game.moveChar(ob, dirx, Math.abs(game.xcurrentspeed / 2), diry, Math.abs(ob.velocity / 2));
    game.moveChar(ob, dirx, Math.abs(game.xcurrentspeed / 2), diry, Math.abs(ob.velocity / 2));
};
game.moveChar = function (ob, dirx, xspeed, diry, yspeed) {
    game.grabCorners(ob.x + dirx * xspeed, ob.y, ob);
    if (dirx == -1) {
        ob.xtileTwo = Math.floor((ob.x - dirx * xspeed) / game.tileW);
        if (ob.upleft && ob.downleft) {
            ob.x = ob.x + xspeed * dirx;
        }
        else {
            ob.x = ob.xtileTwo * game.tileW;
        }
        if (ob.upleftK && ob.downleftK) {
            game.death = true;
        }
    }
    else if (dirx == 1) {
        ob.xtileTwo = Math.floor((ob.x + dirx * xspeed) / game.tileW);
        if (ob.upright && ob.downright) {
            ob.x = ob.x + xspeed * dirx;
        }
        else {
            ob.x = ob.xtileTwo * game.tileW + (game.tileW - ob.width * 2);
        }
        if (ob.uprightK && ob.downrightK) {
            game.death = true;
        }
    }
    game.grabCorners(ob.x, ob.y + diry * yspeed, ob);
    if (diry == -1) {
        ob.ytileTwo = Math.floor((ob.y - diry * yspeed) / game.tileH);
        if (ob.upleft && ob.upright) {
            ob.y = ob.y + yspeed * diry;
        }
        else {
            ob.y = ob.ytileTwo * game.tileH;
            ob.velocity = 0;
        }
        if (ob.upleftK && ob.uprightK) {
            game.death = true;
        }
    }
    else if (diry == 1) {
        ob.ytileTwo = Math.floor((ob.y + diry * yspeed) / game.tileH);
        if (ob.downleft && ob.downright) {
            ob.y = ob.y + yspeed * diry;
        }
        else {
            ob.y = ob.ytileTwo * game.tileH + (game.tileH - ob.height * 2);
            ob.velocity = 0;
            ob.jump = false;
            soundplay = "jump" + (random(4) + 1);
            _root[soundplay].start(0, 1);
            if (game.bgirlon == true) {
                game.clip.attachMovie("blands", "dust" + game.dustn, game.depth);
            }
            else if (game.ccon == true) {
                game.clip.attachMovie("clands", "dust" + game.dustn, game.depth);
            }
            else if (game.gishon == true) {
                game.clip.attachMovie("glands", "dust" + game.dustn, game.depth);
            }
            else if (!game.drfeton) {
                game.clip.attachMovie("lands", "dust" + game.dustn, game.depth);
            }
            game.depth = game.depth + 1;
            game.clip["dust" + game.dustn]._x = ob.x - (ob.width * 2 - game.clip["dust" + game.dustn]._width / 2);
            game.clip["dust" + game.dustn]._y = ob.y + ob.height;
            game.clip["dust" + game.dustn].timer = 12;
            game.dustArray.push(game.dustn);
            game.dustn = game.dustn + 1;
            game.landanimation = true;
            game.grabCorners(ob.x, ob.y + 1, ob);
            if (!ob.downleftBLD && !ob.downleft && !ob.downleftNB) {
                if (game.bgirlon == true) {
                    game.clip.attachMovie("bhmarks", "mark" + game.markn, game.depth);
                }
                else if (game.ccon == true) {
                    game.clip.attachMovie("chmarks", "mark" + game.markn, game.depth);
                }
                else if (game.gishon == true) {
                    game.clip.attachMovie("ghmarks", "mark" + game.markn, game.depth);
                }
                else if (!game.drfeton) {
                    game.clip.attachMovie("hmarks", "mark" + game.markn, game.depth);
                }
                game.depth = game.depth + 1;
                game.clip["mark" + game.markn]._x = ob.leftX * game.tileW;
                game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
                game.clip["mark" + game.markn].cacheAsBitmap = true;
                game.markn = game.markn + 1;
                game.use["t_" + ob.leftX + "_" + ob.downY].bloodDown = true;
            }
            if (!ob.downrightBLD && !ob.downright && !ob.downrightNB) {
                if (game.bgirlon == true) {
                    game.clip.attachMovie("bhmarks", "mark" + game.markn, game.depth);
                }
                else if (game.ccon == true) {
                    game.clip.attachMovie("chmarks", "mark" + game.markn, game.depth);
                }
                else if (game.gishon == true) {
                    game.clip.attachMovie("ghmarks", "mark" + game.markn, game.depth);
                }
                else if (!game.drfeton) {
                    game.clip.attachMovie("hmarks", "mark" + game.markn, game.depth);
                }
                game.depth = game.depth + 1;
                game.clip["mark" + game.markn]._x = ob.rightX * game.tileW;
                game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
                game.clip["mark" + game.markn].cacheAsBitmap = true;
                game.markn = game.markn + 1;
                game.use["t_" + ob.rightX + "_" + ob.downY].bloodDown = true;
            }
        }
        if (ob.downleftK && ob.downrightK) {
            game.death = true;
        }
    }
    ob.clip._x = ob.x;
    ob.clip._y = ob.y;
};
game.grabCorners = function (x, y, ob) {
    ob.downY = Math.floor((y + ob.height * 2 - 1) / game.tileH);
    ob.upY = Math.floor(y / game.tileH);
    ob.leftX = Math.floor(x / game.tileW);
    ob.rightX = Math.floor((x + ob.width * 2 - 1) / game.tileW);
    ob.downYK = Math.floor((y + ob.height * 2) / game.tileH);
    ob.upYK = Math.floor(y / game.tileH);
    ob.leftXK = Math.floor(x / game.tileW);
    ob.rightXK = Math.floor((x + ob.width * 2) / game.tileW);
    ob.upleft = game.use["t_" + ob.leftX + "_" + ob.upY].walkable;
    ob.downleft = game.use["t_" + ob.leftX + "_" + ob.downY].walkable;
    ob.upright = game.use["t_" + ob.rightX + "_" + ob.upY].walkable;
    ob.downright = game.use["t_" + ob.rightX + "_" + ob.downY].walkable;
    ob.upleftK = game.use["t_" + ob.leftXK + "_" + ob.upYK].deadly;
    ob.downleftK = game.use["t_" + ob.leftXK + "_" + ob.downYK].deadly;
    ob.uprightK = game.use["t_" + ob.rightXK + "_" + ob.upYK].deadly;
    ob.downrightK = game.use["t_" + ob.rightXK + "_" + ob.downYK].deadly;
    if (game.use["t_" + ob.leftXK + "_" + ob.upYK].deadly) {
        game.dtype = game.use["t_" + ob.leftXK + "_" + ob.upYK].dtype;
        game.dsound = game.use["t_" + ob.leftXK + "_" + ob.upYK].dsound;
    }
    if (game.use["t_" + ob.leftXK + "_" + ob.downYK].deadly) {
        game.dtype = game.use["t_" + ob.leftXK + "_" + ob.downYK].dtype;
        game.dsound = game.use["t_" + ob.leftXK + "_" + ob.downYK].dsound;
    }
    if (game.use["t_" + ob.rightXK + "_" + ob.upYK].deadly) {
        game.dtype = game.use["t_" + ob.rightXK + "_" + ob.upYK].dtype;
        game.dsound = game.use["t_" + ob.rightXK + "_" + ob.upYK].dsound;
    }
    if (game.use["t_" + ob.rightXK + "_" + ob.downYK].deadly) {
        game.dtype = game.use["t_" + ob.rightXK + "_" + ob.downYK].dtype;
        game.dsound = game.use["t_" + ob.rightXK + "_" + ob.downYK].dsound;
    }
    if (game.use["t_" + ob.leftXK + "_" + ob.downYK].deadlyup) {
        ob.downleftK = game.use["t_" + ob.leftXK + "_" + ob.downYK].deadlyup;
        game.dtype = game.use["t_" + ob.leftXK + "_" + ob.downYK].dtype;
        game.dsound = game.use["t_" + ob.leftXK + "_" + ob.downYK].dsound;
    }
    if (game.use["t_" + ob.rightXK + "_" + ob.downYK].deadlyup) {
        ob.uprightK = game.use["t_" + ob.rightXK + "_" + ob.downYK].deadlyup;
        game.dtype = game.use["t_" + ob.rightXK + "_" + ob.downYK].dtype;
        game.dsound = game.use["t_" + ob.rightXK + "_" + ob.downYK].dsound;
    }
    ob.upleftA = game.use["t_" + ob.leftXK + "_" + ob.upYK].activated;
    ob.downleftA = game.use["t_" + ob.leftXK + "_" + ob.downYK].activated;
    ob.uprightA = game.use["t_" + ob.rightXK + "_" + ob.upYK].activated;
    ob.downrightA = game.use["t_" + ob.rightXK + "_" + ob.downYK].activated;
    if (ob.upleftA == false) {
        game.use["t_" + ob.leftXK + "_" + ob.upYK].activated = true;
    }
    if (ob.downleftA == false) {
        game.use["t_" + ob.leftXK + "_" + ob.downYK].activated = true;
    }
    if (ob.uprightA == false) {
        game.use["t_" + ob.rightXK + "_" + ob.upYK].activated = true;
    }
    if (ob.downrightA == false) {
        game.use["t_" + ob.rightXK + "_" + ob.downYK].activated = true;
    }
    ob.upleftJ = game.use["t_" + ob.leftXK + "_" + ob.upYK].ypull;
    ob.downleftJ = game.use["t_" + ob.leftXK + "_" + ob.downYK].ypull;
    ob.uprightJ = game.use["t_" + ob.rightXK + "_" + ob.upYK].ypull;
    ob.downrightJ = game.use["t_" + ob.rightXK + "_" + ob.downYK].ypull;
    if (ob.upleftJ) {
        ob.ypull = ob.upleftJ;
    }
    else if (ob.downleftJ) {
        ob.ypull = ob.downleftJ;
    }
    else if (ob.uprightJ) {
        ob.ypull = ob.uprightJ;
    }
    else if (ob.downrightJ) {
        ob.ypull = ob.downrightJ;
    }
    else {
        ob.ypull = 0;
    }
    ob.downleftBLD = game.use["t_" + ob.leftX + "_" + ob.downY].bloodDown;
    ob.downrightBLD = game.use["t_" + ob.rightX + "_" + ob.downY].bloodDown;
    ob.upleftBLL = game.use["t_" + ob.leftX + "_" + ob.upY].bloodLeft;
    ob.downleftBLL = game.use["t_" + ob.leftX + "_" + ob.downY].bloodLeft;
    ob.uprightBLR = game.use["t_" + ob.rightX + "_" + ob.upY].bloodRight;
    ob.downrightBLR = game.use["t_" + ob.rightX + "_" + ob.downY].bloodRight;
    ob.upleftNB = game.use["t_" + ob.leftX + "_" + ob.upY].noblood;
    ob.downleftNB = game.use["t_" + ob.leftX + "_" + ob.downY].noblood;
    ob.uprightNB = game.use["t_" + ob.rightX + "_" + ob.upY].noblood;
    ob.downrightNB = game.use["t_" + ob.rightX + "_" + ob.downY].noblood;
};
game.jumpcheck = function (ob) {
    if (ob.velocity == undefined) {
        ob.velocity = 0;
    }
    game.grabCorners(ob.x, ob.y + 1, ob);
    if (ob.downleft && ob.downright) {
        ob.jump = true;
    }
    else {
        ob.jump = false;
    }
    if (ob.jump == true) {
        game.grabCorners(ob.x - 1, ob.y, ob);
        if (!ob.downleft || !ob.upleft) {
            ob.walljump = true;
            ob.walljumpr = true;
            ob.walljumpl = false;
            if (!ob.wallland) {
                if (game.bgirlon == true) {
                    game.clip.attachMovie("blwalls", "dust" + game.dustn, game.depth);
                }
                else if (game.ccon == true) {
                    game.clip.attachMovie("clwalls", "dust" + game.dustn, game.depth);
                }
                else if (game.gishon == true) {
                    game.clip.attachMovie("glwalls", "dust" + game.dustn, game.depth);
                }
                else if (!game.drfeton) {
                    game.clip.attachMovie("lwalls", "dust" + game.dustn, game.depth);
                }
                soundplay = "jump" + (random(4) + 1);
                _root[soundplay].start(0, 1);
                game.depth = game.depth + 1;
                game.clip["dust" + game.dustn]._x = ob.x;
                game.clip["dust" + game.dustn]._y = ob.y - (ob.height * 2 - game.clip["dust" + game.dustn]._height / 2);
                game.clip["dust" + game.dustn].timer = 12;
                game.dustArray.push(game.dustn);
                game.dustn = game.dustn + 1;
                ob.wallland = true;
            }
            if (!ob.upleftBLL && !ob.upleft && !ob.upleftNB) {
                if (game.bgirlon == true) {
                    game.clip.attachMovie("bvmarks", "mark" + game.markn, game.depth);
                }
                else if (game.ccon == true) {
                    game.clip.attachMovie("cvmarks", "mark" + game.markn, game.depth);
                }
                else if (game.gishon == true) {
                    game.clip.attachMovie("gvmarks", "mark" + game.markn, game.depth);
                }
                else if (!game.drfeton) {
                    game.clip.attachMovie("vmarks", "mark" + game.markn, game.depth);
                }
                game.depth = game.depth + 1;
                game.clip.char.swapDepths(game.depth);
                game.depth = game.depth + 1;
                game.clip["mark" + game.markn]._x = (ob.leftX + 1) * game.tileW - 2;
                game.clip["mark" + game.markn]._y = ob.upY * game.tileH;
                game.clip["mark" + game.markn].xscale = -100;
                game.clip["mark" + game.markn].cacheAsBitmap = true;
                game.markn = game.markn + 1;
                game.use["t_" + (ob.leftX + 1) + "_" + ob.upY].bloodLeft = true;
            }
            if (!ob.downleftBLL && !ob.downleft && !ob.downleftNB) {
                if (game.bgirlon == true) {
                    game.clip.attachMovie("bvmarks", "mark" + game.markn, game.depth);
                }
                else if (game.ccon == true) {
                    game.clip.attachMovie("cvmarks", "mark" + game.markn, game.depth);
                }
                else if (game.gishon == true) {
                    game.clip.attachMovie("gvmarks", "mark" + game.markn, game.depth);
                }
                else if (!game.drfeton) {
                    game.clip.attachMovie("vmarks", "mark" + game.markn, game.depth);
                }
                game.depth = game.depth + 1;
                game.clip.char.swapDepths(game.depth);
                game.depth = game.depth + 1;
                game.clip["mark" + game.markn]._x = (ob.leftX + 1) * game.tileW - 2;
                game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
                game.clip["mark" + game.markn].xscale = -100;
                game.clip["mark" + game.markn].cacheAsBitmap = true;
                game.markn = game.markn + 1;
                game.use["t_" + (ob.leftX + 1) + "_" + ob.downY].bloodLeft = true;
            }
            game.cdir = 1;
            ob.walldir = 1;
        }
        else {
            game.grabCorners(ob.x + 1, ob.y, ob);
            if (!ob.downright || !ob.upright) {
                ob.walljump = true;
                ob.walljumpr = false;
                ob.walljumpl = true;
                if (!ob.wallland) {
                    soundplay = "jump" + (random(4) + 1);
                    _root[soundplay].start(0, 1);
                    if (game.bgirlon == true) {
                        game.clip.attachMovie("blwalls", "dust" + game.dustn, game.depth);
                    }
                    else if (game.ccon == true) {
                        game.clip.attachMovie("clwalls", "dust" + game.dustn, game.depth);
                    }
                    else if (game.gishon == true) {
                        game.clip.attachMovie("glwalls", "dust" + game.dustn, game.depth);
                    }
                    else if (!game.drfeton) {
                        game.clip.attachMovie("lwalls", "dust" + game.dustn, game.depth);
                    }
                    game.depth = game.depth + 1;
                    game.clip["dust" + game.dustn]._x = ob.x + ob.width * 2;
                    game.clip["dust" + game.dustn]._y = ob.y + (- ob.height * 2 - game.clip["dust" + game.dustn]._height / 2);
                    game.clip["dust" + game.dustn]._xscale = -100;
                    game.clip["dust" + game.dustn].timer = 12;
                    game.dustArray.push(game.dustn);
                    game.dustn = game.dustn + 1;
                    ob.wallland = true;
                }
                if (!ob.uprightBLR && !ob.upright && !ob.uprightNB) {
                    if (game.bgirlon == true) {
                        game.clip.attachMovie("bvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (game.ccon == true) {
                        game.clip.attachMovie("cvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (game.gishon == true) {
                        game.clip.attachMovie("gvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (!game.drfeton) {
                        game.clip.attachMovie("vmarks", "mark" + game.markn, game.depth);
                    }
                    game.depth = game.depth + 1;
                    game.clip.char.swapDepths(game.depth);
                    game.depth = game.depth + 1;
                    game.clip["mark" + game.markn]._x = ob.rightX * game.tileW + 2;
                    game.clip["mark" + game.markn]._y = ob.upY * game.tileH;
                    game.clip["mark" + game.markn]._xscale = -100;
                    game.clip["mark" + game.markn].cacheAsBitmap = true;
                    game.markn = game.markn + 1;
                    game.use["t_" + ob.rightX + "_" + ob.upY].bloodRight = true;
                }
                if (!ob.downrightBLR && !ob.downright && !ob.downrightNB) {
                    if (game.bgirlon == true) {
                        game.clip.attachMovie("bvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (game.ccon == true) {
                        game.clip.attachMovie("cvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (game.gishon == true) {
                        game.clip.attachMovie("gvmarks", "mark" + game.markn, game.depth);
                    }
                    else if (!game.drfeton) {
                        game.clip.attachMovie("vmarks", "mark" + game.markn, game.depth);
                    }
                    game.depth = game.depth + 1;
                    game.clip.char.swapDepths(game.depth);
                    game.depth = game.depth + 1;
                    game.clip["mark" + game.markn]._x = ob.rightX * game.tileW + 2;
                    game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
                    game.clip["mark" + game.markn]._xscale = -100;
                    game.clip["mark" + game.markn].cacheAsBitmap = true;
                    game.markn = game.markn + 1;
                    game.use["t_" + ob.rightX + "_" + ob.downY].bloodRight = true;
                }
                game.cdir = -1;
                ob.walldir = -1;
            }
            else {
                ob.walljump = false;
                ob.walljumpr = false;
                ob.walljumpl = false;
                ob.wallland = false;
                ob.walldir = 0;
            }
        }
    }
    else {
        ob.walljump = false;
        ob.walljumpr = false;
        ob.walljumpl = false;
        ob.wallland = false;
        ob.walldir = 0;
    }
    if ((Key.isDown(32) || Key.isDown(65)) && game.space && ob.walljump == true && ob.jump == true) {
        ob.velocity = -8;
        game.xcurrentspeed = ob.walldir * 7;
        game.space = false;
        ob.wallland = false;
        ob.walljump = false;
        soundplay = "jump" + (random(4) + 1);
        _root[soundplay].start(0, 1);
        if (ob.walljumpr) {
            if (game.bgirlon == true) {
                game.clip.attachMovie("bjwalls", "dust" + game.dustn, game.depth);
            }
            else if (game.ccon == true) {
                game.clip.attachMovie("cjwalls", "dust" + game.dustn, game.depth);
            }
            else if (game.gishon == true) {
                game.clip.attachMovie("gjwalls", "dust" + game.dustn, game.depth);
            }
            else if (!game.drfeton) {
                game.clip.attachMovie("jwalls", "dust" + game.dustn, game.depth);
            }
            game.depth = game.depth + 1;
            game.clip["dust" + game.dustn]._x = ob.x;
            game.clip["dust" + game.dustn]._y = ob.y + (- ob.height * 2 - game.clip["dust" + game.dustn]._height / 2);
            game.clip["dust" + game.dustn].timer = 12;
            game.dustArray.push(game.dustn);
            game.dustn = game.dustn + 1;
        }
        else if (ob.walljumpl) {
            if (game.bgirlon == true) {
                game.clip.attachMovie("bjwalls", "dust" + game.dustn, game.depth);
            }
            else if (game.ccon == true) {
                game.clip.attachMovie("cjwalls", "dust" + game.dustn, game.depth);
            }
            else if (game.gishon == true) {
                game.clip.attachMovie("gjwalls", "dust" + game.dustn, game.depth);
            }
            else if (!game.drfeton) {
                game.clip.attachMovie("jwalls", "dust" + game.dustn, game.depth);
            }
            game.depth = game.depth + 1;
            game.clip["dust" + game.dustn]._x = ob.x + ob.width * 2;
            game.clip["dust" + game.dustn]._y = ob.y + (- ob.height * 2 - game.clip["dust" + game.dustn]._height / 2);
            game.clip["dust" + game.dustn]._xscale = -100;
            game.clip["dust" + game.dustn].timer = 12;
            game.dustArray.push(game.dustn);
            game.dustn = game.dustn + 1;
        }
    }
    if ((Key.isDown(32) || Key.isDown(65)) && game.space && ob.jump == false) {
        ob.velocity = -8;
        ob.jump = true;
        game.space = false;
        soundplay = "jump" + (random(4) + 1);
        _root[soundplay].start(0, 1);
        if (game.bgirlon == true) {
            game.clip.attachMovie("bjumps", "dust" + game.dustn, game.depth);
        }
        else if (game.ccon == true) {
            game.clip.attachMovie("cjumps", "dust" + game.dustn, game.depth);
        }
        else if (game.gishon == true) {
            game.clip.attachMovie("gjumps", "dust" + game.dustn, game.depth);
        }
        else if (!game.drfeton) {
            game.clip.attachMovie("jumps", "dust" + game.dustn, game.depth);
        }
        game.depth = game.depth + 1;
        game.clip["dust" + game.dustn]._x = ob.x - (ob.width * 2 - game.clip["dust" + game.dustn]._width / 2);
        game.clip["dust" + game.dustn]._y = ob.y - (ob.height + game.clip["dust" + game.dustn]._height);
        game.clip["dust" + game.dustn].timer = 12;
        game.dustArray.push(game.dustn);
        game.dustn = game.dustn + 1;
        game.grabCorners(ob.x, ob.y + 1, ob);
        if (!ob.downleftBLD && !ob.downleft && !ob.downleftNB) {
            if (game.bgirlon == true) {
                game.clip.attachMovie("bhmarks", "mark" + game.markn, game.depth);
            }
            else if (game.ccon == true) {
                game.clip.attachMovie("chmarks", "mark" + game.markn, game.depth);
            }
            else if (game.gishon == true) {
                game.clip.attachMovie("ghmarks", "mark" + game.markn, game.depth);
            }
            else if (!game.drfeton) {
                game.clip.attachMovie("hmarks", "mark" + game.markn, game.depth);
            }
            game.depth = game.depth + 1;
            game.clip["mark" + game.markn]._x = ob.leftX * game.tileW;
            game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
            game.clip["mark" + game.markn].cacheAsBitmap = true;
            game.markn = game.markn + 1;
            game.use["t_" + ob.leftX + "_" + ob.downY].bloodDown = true;
        }
        if (!ob.downrightBLD && !ob.downright && !ob.downrightNB) {
            if (game.bgirlon == true) {
                game.clip.attachMovie("bhmarks", "mark" + game.markn, game.depth);
            }
            else if (game.ccon == true) {
                game.clip.attachMovie("chmarks", "mark" + game.markn, game.depth);
            }
            else if (game.gishon == true) {
                game.clip.attachMovie("ghmarks", "mark" + game.markn, game.depth);
            }
            else if (!game.drfeton) {
                game.clip.attachMovie("hmarks", "mark" + game.markn, game.depth);
            }
            game.depth = game.depth + 1;
            game.clip["mark" + game.markn]._x = ob.rightX * game.tileW;
            game.clip["mark" + game.markn]._y = ob.downY * game.tileH;
            game.clip["mark" + game.markn].cacheAsBitmap = true;
            game.markn = game.markn + 1;
            game.use["t_" + ob.rightX + "_" + ob.downY].bloodDown = true;
        }
    }
    else if (ob.jump == true && ob.velocity < game.maxVel) {
        ob.velocity = ob.velocity + 0.5;
    }
};


game.levelProgression = function (c) {
    if (game.leveltype == "static" && game.mapBuilt == false) {
        char = _root["map" + game.mapnumber + "char"];
        map = _root["map" + game.mapnumber];
        var _loc2_ = _root["mapbg" + game.mapnumber];
        bgt = _root["mapbg" + game.mapnumber];
        scrolly = _root["mapscroll" + game.mapnumber];
        string = _root["map" + game.mapnumber + "statement"];
        strue = _root["map" + game.mapnumber + "stringplayed"];
        comic = _root["map" + game.mapnumber + "comic"];
        ctrue = _root["map" + game.mapnumber + "comicplay"];
        final = _root["map" + game.mapnumber + "final"];
    }
    else if (game.leveltype == "custom" && game.mapBuilt == false) {
        char = game.custom["savegame" + c].char;
        map = game.custom["savegame" + c].array;
        _loc2_ = game.custom["savegame" + c].bg;
        bgt = game.custom["savegame" + c].bg;
        scrolly = game.custom["savegame" + c].scroll;
        string = false;
        strue = true;
        comic = false;
        ctrue = true;
        final = false;
    }
    if (game.mapBuilt == false) {
        game.damsync = 50;
        game.damtypephase = true;
        _root.loader.swapDepths(0);
        game.baid = false;
        game.invincibleTimer = 10;
        game.rebornTimer = 23;
        game.buildmap(map, char, movt);
        game.mapBuilt = true;
        game.bnumber = 0;
        game.blockplace = 0;
        game.bArray = new Array();
        game.currchar = char;
        chat.suckvelocityY = 0;
        game.dustn = 0;
        game.dtype = false;
        game.dsound = false;
        game.markn = 0;
        game.dustArray = new Array();
        _root.bg.removeMovieClip();
        _root.attachMovie("bg", "bg", 1);
        _root.bg.gotoAndStop(_loc2_);
        _root.bg._y = (_root.bg._height - Stage.height) * -1;
        musplay = "music" + (_loc2_ - 1) + "_1";
        if (string && !strue || comic && !ctrue) {
            game.clip.char.gotoAndStop("nothing");
        }
        else if (game.cdir == 1) {
            game.clip.char.gotoAndStop("rebornright");
        }
        else if (game.cdir == -1) {
            game.clip.char.gotoAndStop("rebornleft");
        }
        if (!muson || muson != _loc2_ - 1) {
            stopAllSounds();
            _root[musplay].start(0, 999);
            muson = _loc2_ - 1;
        }
    }
    else if (comic && !ctrue) {
        game.pause = true;
        if (_root.blackout._alpha >= 50 && _root.blackout._alpha != undefined) {
            game.comicPlay(comic[0], comic[1], comic[2]);
        }
        if (game.ctimerthree <= 0) {
            _root["map" + game.mapnumber + "comicplay"] = true;
            ctrue = _root["map" + game.mapnumber + "comicplay"];
            _root.cmone.removeMovieClip();
            _root.cmtwo.removeMovieClip();
            _root.cmthree.removeMovieClip();
            game.ctimerone = 50;
            game.ctimertwo = 50;
            game.ctimerthree = 50;
            if (!string || strue) {
                game.pause = false;
                if (game.cdir == 1) {
                    game.clip.char.gotoAndStop("rebornright");
                }
                else if (game.cdir == -1) {
                    game.clip.char.gotoAndStop("rebornleft");
                }
            }
        }
    }
    else if (string && !strue) {
        game.pause = true;
        game.instructions(string);
        if (Key.isDown(13) && game.enter == true) {
            game.enter = false;
            game.pause = false;
            if (game.cdir == 1) {
                game.clip.char.gotoAndStop("rebornright");
            }
            else if (game.cdir == -1) {
                game.clip.char.gotoAndStop("rebornleft");
            }
            string = false;
            _root["map" + game.mapnumber + "stringplayed"] = true;
            _root.textbox.removeMovieClip();
        }
    }
    else if (game.rebornTimer > 0) {
        game.rebornTimer--;
    }
    else if (game.checkEnd(char) == false && (game.death == false || game.invincibleTimer > 0)) {
        game.pauseFunction();
        if (!game.pause) {
            game.detectkeys(char);
            game.scrollFunction(char, scrolly);
            game.tileBrain(char);
            game.bulletBrain(char);
            game.charAnimations(char);
            game.particleEngine(game.dustArray);
            game.missileBrain(game.mArray, char);
            if (game.invincibleTimer > 0) {
                game.death = false;
            }
        }
    }
    else if (game.death == true && game.invincibleTimer <= 0) {
        game.xcurrentspeed = 0;
        char.velocity = 0;
        if (game.deathCounter < 30) {
            game.resetLevel = 1;
            game.charDeath(char);
            game.bulletBrain(char);
            game.missileBrain(game.mArray, char);
            game.deathCounter = game.deathCounter + 1;
        }
        else if (game.deathCounter >= 30) {
            _root.bg.gotoAndStop("load");
            game.clip.removeMovieClip();
            _root.textbox.removeMovieClip();
            _root.createEmptyMovieClip("OverL", game.depth);
            game.clip = _root.OverL;
            game.pause = false;
            game.mapBuilt = false;
            game.death = false;
            game.deathCounter = 0;
            game.deathStage = 1;
        }
    }
    else if (game.cutsceneTimer > 0) {
        game.cutsceneTimer--;
        if (!_root.cutscene) {
            _root.attachMovie(game.cutscene, "cutscene", game.depth);
            _root.cutscene._x = 150;
            _root.cutscene._y = 250;
            game.depth = game.depth + 1;
        }
        if (game.cutsceneTimer - 1 <= 0) {
            game.unlockable = false;
            game.cutsceneTimer = 0;
            _root.cutscene.removeMovieClip();
            final = false;
            if (!enterUnlockables) {
                game.menuStage = "mainmenu";
                game.menuBuilt = false;
                game.mapBuilt = false;
                _root.createEmptyMovieClip("OverL", game.depth);
                game.clip = _root.OverL;
                game.pause = true;
                _root.attachMovie("bg", "bg", 1);
                _root.bg.gotoAndStop(1);
                _root.bg.introduction.gotoAndStop(290);
                titleMenuSound.start(0, 99);
            }
            else {
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.createEmptyMovieClip("OverL", game.depth);
                game.clip = _root.OverL;
                if (game.mapnumber + 1 != 1 && game.mapnumber + 1 != 17 && game.mapnumber + 1 != 33 && game.mapnumber + 1 != 50) {
                    game.mapnumber = game.mapnumber + 1;
                }
                else {
                    game.mapnumber = game.mapnumber + 2;
                }
                game.pause = false;
                game.mapBuilt = false;
            }
        }
    }
    else {
        game.pause = true;
        if (game.leveltype == "static") {
            _root["map" + game.mapnumber + "beaten"] = true;
            game.savefile.data["map" + game.mapnumber + "beaten"] = true;
            if (game.baid) {
                _root["map" + game.mapnumber + "baid"] = true;
                game.savefile.data["map" + game.mapnumber + "baid"] = true;
            }
            game.savefile.flush();
        }
        if (game.mapnumber + 1 != 1 && game.mapnumber + 1 != 17 && game.mapnumber + 1 != 33 && game.mapnumber + 1 != 50) {
            game.holdmapnumtemp = game.mapnumber + 1;
        }
        else {
            game.holdmapnumtemp = game.mapnumber + 2;
        }
        game.unlockLevels();
        game.unlockSecrets();
        game.endLevel();
        if (Key.isDown(13) && game.enter == true && game.mapnumber < game.mapamount - 1 && game.leveltype == "static" && _root["map" + (game.mapnumber + 1) + "unlocked"] == true) {
            game.enter = false;
            if (!final && !game.unlockable) {
                _root.bg.gotoAndStop("load");
                _root.loader.swapDepths(game.depth);
                game.depth = game.depth + 1;
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.createEmptyMovieClip("OverL", game.depth);
                game.clip = _root.OverL;
                if (game.mapnumber + 1 != 1 && game.mapnumber + 1 != 17 && game.mapnumber + 1 != 33 && game.mapnumber + 1 != 50) {
                    game.mapnumber = game.mapnumber + 1;
                }
                else {
                    game.mapnumber = game.mapnumber + 2;
                }
                game.pause = false;
                game.mapBuilt = false;
            }
            else if (final) {
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.bg.removeMovieClip();
                game.pause = false;
                stopAllSounds();
                muson = false;
                game.cutsceneTimer = 2850;
                game.cutscene = "ending";
                game.bgirlunlocked = true;
                game.savefile.data.bgirlunlocked = true;
            }
            else if (game.unlockable) {
                enterUnlockables = true;
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.bg.removeMovieClip();
                game.pause = false;
                stopAllSounds();
                muson = false;
                game.cutsceneTimer = 100;
                game.cutscene = game.unlockable;
            }
        }
        else if (Key.isDown(27) && game.escape == true) {
            game.escape = false;
            if (!final && !game.unlockable) {
                _root.bg.removeMovieClip();
                _root.attachMovie("bg", "bg", 1);
                _root.bg.gotoAndStop(1);
                _root.bg.introduction.gotoAndStop(290);
                game.xcurrentspeed = 0;
                char.velocity = 0;
                _root[char].clip.removeMovieClip();
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.createEmptyMovieClip("OverL", game.depth);
                game.clip = _root.OverL;
                if (game.leveltype == "static") {
                    game.menuStage = "campaignlist";
                }
                else if (game.leveltype == "custom") {
                    game.menuStage = "loadcustom";
                }
                game.mapBuilt = false;
            }
            else if (final) {
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.bg.removeMovieClip();
                game.pause = false;
                stopAllSounds();
                muson = false;
                game.cutsceneTimer = 2850;
                game.cutscene = "ending";
                game.bgirlunlocked = true;
                game.savefile.data.bgirlunlocked = true;
            }
            else if (game.unlockable) {
                game.xcurrentspeed = 0;
                char.velocity = 0;
                game.clip.removeMovieClip();
                _root.textbox.removeMovieClip();
                _root.bg.removeMovieClip();
                game.pause = false;
                stopAllSounds();
                muson = false;
                game.cutsceneTimer = 100;
                game.cutscene = game.unlockable;
            }
        }
    }
};
